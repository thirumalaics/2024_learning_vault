## Indexes
- indexes are pointers or reference to a table record
- index table diff from main table
- storing indexes requires disk space
	- creating an index involves cost
- without an index, queries involving a where clause read the entire data and process
- indexing in hive is only present for ORC file format, as it has a built-in index with it
- there are two types of indexing in Hive
	- BitMap Indexing: std technique for indexing columns with few distinct values
		- stores combination of indexed column value and list of rows as a bitmap
	- compact indexing stores the pair of indexed column's value and its block id
- the main difference is how they store the mapping of col values to the rows in which the value occurs
- indexes has been removed with Hive3.0
	- recommended to use materialized view to achieve similar results
	- general recco is to use file format like Parquet and ORC
		- both are columnar and can avoid all column scan
		- also orc has built in indexes which allows skipping blocks of data during read
- `create index i1 on table table9(col3) as 'COMPACT' with deferred rebuild;`
	- the index will be empty after creation regardless of whether the table has data or not
		- only after rebuilding with alter command, index gets populated
		- `alter index i1 on table9 rebuild;` updates our index
			- obviously mr job triggered
	- allows us to alter the index later using the alter statement
	- after creation of data, data is changed in the base table and our index table is unaware of the change
		- so make the index table up-to-date, we have to rebuild it by using alter command
- index table can be stored in any file format
	- `create index i2 on table table9(col3) as 'COMPACT' with deferred rebuild stored as rcfile;`
	- rcfile(record columnar file) - data placement structure designed for MR based dwh sys
	- `CREATE INDEX I3 on table table9(col3) as 'COMPACT' with deferred rebuild row format delimited fields terminated by '\n' stored as textfile`
	- we can also create index tables using index properties and table properties 

- can a table have multiple indexes
	- yes, there is no limit on the number and types of indexes, and on what columns
	- `create index i4 on table table9(col3) as 'BITMAP' with deferred rebuild;`
		- this should be followed by: `ALTER INDEX i4 on table9 rebuild;`
- to display indexes created for a table: `show formatted index on table9;`
- if table column has multiple indexes created of different or same type, the index that got created first is preferred for queries querying that particular column
	- i thought that it would be possible to hint in query to pick a certain index
- `drop index i1 on table9;`
	- dropping index
- when to use indexes
	- dataset is large
	- performance demand
	- frequent use of filtering
- when not to use
	- dataset is unique
	- no frequent use of where clause in queries
	- building more indexes degrades performance in queries

## UDF
- funcs mostly written in java
- some rules to be adhered to while writing UDF's
- to run a udf in hive:
	- create a java program in any platform
		- add basic jar files for any mr job to run
		- there is also a specific jar file to be added to run the udf program
			- this jar file will be present where we have installed our hive
			- all the classes and functions that we will inherit in our java program have definitions in this jar file
			- UDF class from this jar needs to be extended and evaluate function should be overridden with the implementation we need
	- save or convert the program into jar file
	- add the jar file into Hive shell
		- `add jar /path/to/jarfile.jar;`
	- create a function of the jar file added
		- 2 types can be created
			- temp(limited to the session) and permanent
			- `CREATE TEMPORARY FUNCTION f2 as 'com.hive1.ud2';`
				- ud2 is the class name, com.hive1 is package name
	- use the func in hive query
		- `select col1, f2(col2) from table20;`

## Table properties
- two types 
	- active or passive
	- passive properties just tag a table and have to functionality
		- ex: creator name
	- active: has effect on the table
		- skip.header.line.count
			- `create table table1 (col1 string, col2 int) row format delimited fields terminated by ',' lines terminated by '\n' stored as text file tblproperties("skip.header.line.count" = "3");`
			- skips the first three lines of the datafiles
			- `load data local inpath '/home/thendi/file' into table table1;`
		- `skip.footer.line.count`
			- `create table table1 (col1 string, col2 int) row format delimited fields terminated by ',' lines terminated by '\n' stored as text file tblproperties("skip.footer.line.count" = "3");`