## Relational Entities on Db
- Databases
	- is equivalent to Schemas in Hive metastore
		- what is schemas on hive?
	- this is the reason, to create a Database in DB:
		- `CREATE DATABASE db_name;`
		- `CREATE SCHEMA db_name;`
	- Hive Metastore in DB
		- repository of metadata
		- it stores information for data structures, such as 
			- databases, tables and partitions
		- it holds information like the table definition, format of the data, location of the data in underlying storage
		- every DB workspace has a central HMS accessible by ***all clusters*** to persist table md
			- so one ws can have multiple clusters?
		- md tracked by HMS irrespective of where the files/folders for tables/databases reside
	- to create some tables in default db, we can use CREATE TABLE statement without any db name
		- table definition will be under default database in the HMS
		- what happens when we run a create table command in databricks
		- the table data will be located directly under the hive default directory: `/user/hive/warehouse`
			- for each table under default db, there will be a folder here
			- files for the tables, along with \_delta\_log folder goes under the respective table's directory
	- creating a new schema or db creates a folder for the db under default hive directory
		- the db will be created in the HMS
		- if the db name is schems, folder under `dbfs:/user/hive/warehouse/schems.db`
		- ![[Pasted image 20240628085335.png]]
		- `use schems;`
			- to set the current db
			- any table creation without mention of db from this point will create table under schems db
			- folder structure below
			- ![[Pasted image 20240628090022.png]]
		- to create schema in a different location than the hive default dir:
			- `CREATE SCHEMA db_y LOCATION 'dbfs:/custom/path/db_y.db'`
			- no mention of external db
- Tables
	- two types: 
		- managed
			- table is created in storage under the db dir
			- default
			- hive owns both the md and table data
			- HMS manages the lifecycle of the table
			- Dropping the table deletes underlying data
		- external
			- ***table is explicitly created*** in storage outside the db dir
			- path specified by the argument to LOCATION keyword
				- `CREATE TABLE table_name LOCATION 'path'`
			- only md owned by hive
			-  dropping the table will not delete the underlying data files
			- we can use the same path as the default db for ext table
				- not sure
			- creating tables under (dbs created with the location keyword) will create as managed tables only
				- external tables are created when location keyword is given at the time table creation
- the impact of the location keyword
	- it is possible to create dbs outside the default HMS directory
	- `CREATE SCHEMA db_y LOCATION 'dbfs:/custom/path/db_y.db'`
	- the HMS tracks this db as well
	- only the location of data is going to be diff
	- tables created under this db as well tracked by HMS