## DB SQL
- we must be connected to SQLWH to be able to query
- are catalogs, databases and tables tied to a SQLWH
- SQL results can be added to dashboards
	- what this meant in the video: no visualization was created when he added this dashboard. just the results were added to the dashboard
- we can also set a schedule for the query to refresh the results automatically
- queries menu in the sidebar:
	- we can see the saved queries
	- the saved queries can be used to setup alerts
- alerts in dbsql allow us to receive notification when a field of our query meets a certain threshold
- in the alerts menu we can create new alerts and select saved query
	- alerts need to have a name
	- Trigger when option can be set with a value column and a condition
		- ex: total_fare > 10000
	- only the top row value is considered for this condition check, so we may need to consider sorting or a query that returns one row
		- but there is no restriction that the query must return only one row
	- refresh interval can be set on the alert
- alert destination is where the alerts are sent to
	- new alert destinations can be created
	- type of alert destinations: slack, pagerDuty, teams etc....

## Data object privileges
- data governance model
	- allows us to programmatically grant, deny and revoke access to data object for a user or group of users
	- ```GRANT Privilege ON Object <object-name> TO <user or group>```
	- ```GRANT SELECT ON TABLE my_table TO user_1@company.com```
- managing permissions for data objects

![[Pasted image 20240802091111.png]]

![[Pasted image 20240802091353.png]]
- to grant privileges on an object, we need to be either databricks administrator or the object owner
	- databricks administrator can grant access on all objects in the catalog and in the underlying file sys
	- catalog owner can obviously provide access on objects under the catalog![[Pasted image 20240802091833.png]]
- other operations for data governance:
	- GRANT
	- DENY
	- REVOKE
	- SHOW GRANTS
- all of these privileges are within the DBSQL(DWH)
- the SQL Statements can be run in the SQLEditor
- databases can be created and be given a location under dbfs like:
	- `CREATE DATABASE IF NOT EXISTS FOR hr_db LOCATION 'dbfs:/mnt/demo/hr_db.db'`
	- `GRANT SELECT, USAGE, MODIFY, READ_METADATA, CREATE ON SCHEMA hr_db TO hr_team;`
	- for users to perform any operation on a db object, they must have an additional privilege: USAGE
	- `GRANT SELECT, USAGE, MODIFY, READ_METADATA, CREATE ON SCHEMA hr_db TO 'hr_team_member_new@company.com';`
	- `SHOW GRANTS ON SCHEMA hr_db;`
- in addition to SQL based access control, there is a UI called Data/Data Explorer within the SQL person which provides access control
	- allows users and admins to navigate different data objects like dbs, tables and views etc
	- also allows providing permissions
	- UI for access management
- object owner can be changed in UI
	- owner can be individual or a group
- there is a default group called Admins: all workspace admins are present here
- ANY FILE object cannot be granted access from the UI
	- at the time of writing
- DB captures query history against DBSQL objects
	- under Query history menu in SQL persona